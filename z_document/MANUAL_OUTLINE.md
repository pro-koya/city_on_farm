# セッツマルシェ マニュアル概要

このドキュメントは、詳細マニュアル作成前の概要・目次です。
各セクションの方向性を確認し、ずれを防ぐための目印として使用します。

---

## マニュアル構成

1. **購入者向けマニュアル**
   - 1-1. ユーザー登録手順
   - 1-2. 多要素認証（MFA）の設定手順
   - 1-3. 商品購入手順

2. **出品者向けマニュアル**
   - 2-1. 商品作成手順
   - 2-2. 送料・配送可能地域・受け渡し方法の設定手順
   - 2-3. 配送可能日・受け渡し可能日の設定手順
   - 2-4. 取引管理（注文確認から配送・入金確認まで）

---

# 1. 購入者向けマニュアル

## 1-1. ユーザー登録手順

### 目的
新規ユーザーがアカウントを作成し、サービスを利用できるようになる

### 大まかな流れ
1. **サインアップページへアクセス**
   - トップページ右上「新規登録」ボタンをクリック
   - `/signup` ページへ遷移

2. **必要情報の入力**
   - メールアドレス
   - パスワード（確認用含む）
   - 氏名
   - （その他必要項目があれば記載）

3. **利用規約・プライバシーポリシーへの同意**
   - チェックボックスにチェック

4. **登録ボタンをクリック**
   - 入力内容の検証
   - エラーがあれば表示

5. **認証メールの受信**
   - 登録メールアドレスに認証メールが届く
   - 認証待ち画面が表示される

6. **メール内リンクをクリック**
   - メール認証完了
   - ログイン可能状態になる

7. **ログイン**
   - メールアドレスとパスワードでログイン
   - ダッシュボードへ遷移

### 補足事項
- パスワード要件（文字数、文字種など）
- メールが届かない場合の再送方法

---

## 1-2. 多要素認証（MFA）の設定手順

### 目的
アカウントのセキュリティを強化し、不正ログインを防ぐ

### 認証方式
- **認証アプリ（TOTP）**: Google Authenticatorなどを使用
- **パスキー（WebAuthn）**: 指紋認証・顔認証などの生体認証

### 大まかな流れ（認証アプリの場合）
1. **セキュリティ設定ページへアクセス**
   - ダッシュボード → アカウント設定 → セキュリティ
   - `/account/2fa/setup` へ遷移

2. **2要素認証の有効化を開始**
   - 「2要素認証を設定する」ボタンをクリック

3. **QRコードの表示**
   - 画面にQRコードが表示される

4. **認証アプリでスキャン**
   - Google Authenticator等でQRコードをスキャン
   - 6桁のコードが表示される

5. **確認コードの入力**
   - 認証アプリに表示された6桁コードを入力
   - 「確認」ボタンをクリック

6. **バックアップコードの保存**
   - 緊急時用のバックアップコードが表示される
   - 安全な場所に保管

7. **設定完了**
   - 次回ログイン時から2要素認証が必要になる

### 大まかな流れ（パスキーの場合）
1. **セキュリティ設定ページへアクセス**
   - `/account/webauthn/setup` へ遷移

2. **パスキーの登録を開始**
   - 「パスキーを登録する」ボタンをクリック

3. **デバイスの認証**
   - 指紋認証・顔認証などブラウザの認証画面が表示される
   - 認証を実行

4. **パスキー名の設定**
   - 識別用の名前を入力（例：「iPhone」「MacBook」）

5. **登録完了**
   - パスキー一覧に追加される
   - 次回ログイン時からパスキーが使用可能

### 補足事項
- 複数の認証方式を併用可能
- パスキーの削除方法
- 認証アプリを変更する場合の手順
- バックアップコードの再生成

---

## 1-3. 商品購入手順

### 目的
ユーザーが商品を選び、注文を完了する

### 大まかな流れ
1. **商品を探す**
   - トップページの商品一覧から選ぶ
   - カテゴリ・キーワードで検索
   - `/products` ページで絞り込み

2. **商品詳細を確認**
   - `/products/:id` で商品情報を確認
   - 価格、説明、出品者情報を確認
   - **受け取り方法を確認**（配送 or 畑で受け取り）
   - 配送可能地域・受け取り可能日を確認

3. **カートに追加**
   - 数量を選択
   - 「カートに追加」ボタンをクリック

4. **カートを確認**
   - `/cart` でカート内容を確認
   - 数量変更・削除が可能

5. **チェックアウトへ進む**
   - 「購入手続きへ」ボタンをクリック
   - ログインしていない場合はログイン画面へ

6. **受け取り方法の選択**
   - **配送**: 配送先住所を入力
   - **畑で受け取り**: 受け取り日時を選択

7. **クーポンの適用（任意）**
   - クーポンコードがあれば入力
   - 割引が適用される

8. **注文内容の確認**
   - `/checkout/confirm` で最終確認
   - 商品、送料（配送の場合）、合計金額を確認

9. **支払い**
   - クレジットカード情報を入力（Stripe）
   - 「注文を確定する」ボタンをクリック

10. **注文完了**
    - `/checkout/complete` で完了画面
    - 確認メールが届く
    - 注文番号が発行される

### 補足事項
- 注文履歴の確認方法（`/orders/recent`）
- 注文詳細・請求書の確認方法
- 配送状況の確認方法
- 畑での受け取り場所・時間の確認方法

---

# 2. 出品者向けマニュアル

## 2-1. 商品作成手順

### 目的
出品者が新しい商品を登録し、販売を開始する

### 前提条件
- ユーザー登録済み
- 出品者として承認済み（adminによる権限付与）
- セラープロフィール設定済み

### 大まかな流れ
1. **セラーダッシュボードへアクセス**
   - ログイン後、ダッシュボードから「出品者メニュー」へ
   - `/dashboard/seller` または `/seller/listings`

2. **新規商品登録を開始**
   - 「新規商品を登録」ボタンをクリック
   - `/seller/listings/new` へ遷移

3. **基本情報の入力**
   - 商品名
   - 商品説明（詳細な説明文）
   - カテゴリ選択

4. **価格設定**
   - 販売価格
   - （税込/税抜の扱い）

5. **在庫設定**
   - 在庫数
   - 在庫管理方法

6. **商品画像のアップロード**
   - メイン画像
   - サブ画像（複数可）
   - 画像の並び替え

7. **受け取り方法の設定**
   - 配送可能かどうか
   - 畑での受け取り可能かどうか
   - 両方可能な場合は両方にチェック

8. **配送設定（配送可能な場合）**
   - 配送方法の選択
   - 送料ルールの適用（事前設定が必要 → 2-2参照）

9. **公開設定**
   - 下書き保存 or 公開
   - 公開日時の設定（あれば）

10. **確認・保存**
    - 入力内容を確認
    - 「登録する」ボタンをクリック

11. **登録完了**
    - リスティング一覧に商品が追加される
    - ステータス確認（公開中/下書き）

### 補足事項
- 商品の編集方法
- 商品の非公開・削除方法
- 商品画像の推奨サイズ・形式

---

## 2-2. 送料・配送可能地域・受け渡し方法の設定手順

### 目的
出品者が配送方法、送料、配送可能地域、畑での受け渡しを設定する

### 大まかな流れ

### A. 受け渡し方法の設定
1. **配送設定ページへアクセス**
   - セラーダッシュボードから「配送設定」を選択
   - `/seller/shipping-rules` へ遷移

2. **受け渡し方法の選択**
   - **配送**: 商品を購入者の住所へ配送する
   - **畑での受け渡し**: 購入者が畑まで来て受け取る
   - 両方を有効にすることも可能

### B. 配送の設定（配送を選択した場合）
3. **配送方法の追加**
   - 「配送方法を追加」ボタンをクリック
   - 配送業者・方法名を入力（例：ヤマト運輸、ゆうパックなど）

4. **配送可能地域の設定**
   - 全国配送可能
   - または特定地域のみ（都道府県を選択）
   - 配送不可地域の除外設定

5. **送料ルールの設定**
   - 全国一律送料
   - 地域別送料（都道府県・エリアごと）
   - 購入金額による送料無料設定（例：5,000円以上で送料無料）

6. **配送サイズ・重量の設定**
   - サイズ区分（S, M, Lなど）
   - 重量による料金変動（あれば）

7. **特殊配送の設定**
   - クール便・冷凍便の対応
   - 追加料金の設定

### C. 畑での受け渡し設定（畑受け渡しを選択した場合）
8. **受け渡し場所の設定**
   - 畑の住所・場所の説明
   - 目印・アクセス方法

9. **受け渡し時の注意事項**
   - 駐車場の有無
   - 連絡方法
   - その他注意事項

### D. 保存
10. **設定を保存**
    - 「設定を保存」ボタンをクリック
    - 設定が商品に適用される

### 補足事項
- 複数の配送方法を設定する場合
- 商品ごとに送料を上書きする場合
- 季節や天候による配送制限の設定

---

## 2-3. 配送可能日・受け渡し可能日の設定手順

### 目的
出品者が商品を配送できる日、または畑で受け渡しできる日を設定する

### 大まかな流れ

### A. 配送可能日の設定
1. **スケジュール設定ページへアクセス**
   - セラーダッシュボードから「スケジュール設定」を選択
   - または配送設定ページ内のスケジュールタブ

2. **基本的な配送スケジュール**
   - 発送可能な曜日を選択（例：月・水・金のみ発送）
   - 発送までのリードタイム（例：注文から3日以内に発送）

3. **配送不可日の設定**
   - カレンダーから配送できない日を選択
   - 長期休暇・繁忙期などの除外日

4. **配送予定日の目安**
   - 地域ごとの配送日数（例：関西圏は翌日、関東は2日後）

### B. 畑での受け渡し可能日の設定
5. **受け渡し可能な曜日・時間帯**
   - 受け渡し可能な曜日を選択
   - 時間帯の設定（例：10:00〜12:00、14:00〜16:00）

6. **受け渡し枠の設定**
   - 1枠あたりの受け入れ可能人数（例：1時間に3組まで）
   - 同時刻の予約制限

7. **受け渡し不可日の設定**
   - カレンダーから受け渡しできない日を選択
   - 休業日・イベント日などの除外

### C. カレンダー管理
8. **カレンダー表示で確認**
   - 月間カレンダーで配送可能日・受け渡し可能日を視覚的に確認
   - 予約状況の確認

9. **保存**
   - 「設定を保存」ボタンをクリック

### 補足事項
- 急な予定変更時の対応方法
- 予約が入っている日の変更について
- 季節商品の配送期間設定

---

## 2-4. 取引管理（注文確認から配送・入金確認まで）

### 目的
商品が購入された後、配送完了・入金確認までの一連の流れを管理する

### 大まかな流れ

### A. 注文の確認
1. **注文通知の受信**
   - 商品が購入されるとメール通知が届く
   - ダッシュボードにも通知が表示される

2. **取引一覧ページへアクセス**
   - セラーダッシュボードから「取引管理」を選択
   - `/seller/trades` へ遷移

3. **新規注文の確認**
   - ステータスが「新規注文」の取引を確認
   - 注文詳細（商品、数量、金額、購入者情報）を確認

4. **受け取り方法の確認**
   - 配送の場合：配送先住所を確認
   - 畑受け渡しの場合：受け渡し日時を確認

### B. 配送の場合
5. **発送準備**
   - 商品を梱包
   - 配送伝票の準備（システムから印刷可能）

6. **発送処理**
   - 配送業者へ引き渡し
   - 追跡番号の入力

7. **配送ステータスの更新**
   - `/seller/trades/:id` で取引詳細を開く
   - 「発送済み」ステータスに更新
   - 追跡番号を入力・保存
   - 購入者に発送通知メールが送信される

8. **配送完了の確認**
   - 追跡情報で配達完了を確認
   - または購入者からの受け取り報告

### C. 畑での受け渡しの場合
5. **受け渡し日時の確認**
   - 予約された日時を確認
   - 必要に応じて購入者へ連絡

6. **受け渡しの実施**
   - 購入者が畑に来訪
   - 商品を手渡し

7. **受け渡し完了の記録**
   - `/seller/trades/:id` で取引詳細を開く
   - 「受け渡し完了」ステータスに更新

### D. 入金の確認
8. **売上の確認**
   - 取引完了後、売上が確定
   - セラーダッシュボードの「売上管理」で確認

9. **入金スケジュールの確認**
   - Stripe Connectによる入金
   - 入金予定日の確認

10. **入金完了の確認**
    - 登録した銀行口座への入金を確認
    - 入金履歴で明細を確認

### E. 取引ステータス一覧

| ステータス | 説明 |
|-----------|------|
| 新規注文 | 購入直後、未対応の状態 |
| 準備中 | 発送準備・受け渡し準備中 |
| 発送済み | 配送業者へ引き渡し済み |
| 受け渡し待ち | 畑での受け渡し日を待っている状態 |
| 完了 | 配送完了または受け渡し完了 |
| キャンセル | 注文がキャンセルされた状態 |
| 返金処理中 | 返金手続き中 |

### 補足事項
- 一括で複数の取引を更新する方法
- 問題が発生した場合の対応（配送トラブル、キャンセル依頼など）
- 返金処理の手順
- 売上レポートの確認方法

---

# 確認事項

上記の概要について、以下をご確認ください：

1. **対象範囲は適切か？**
   - 他に必要なマニュアルはあるか

2. **各手順の流れは正しいか？**
   - 実際の操作と合っているか

3. **受け渡し方法について**
   - 「配送」と「畑での受け渡し」の2種類で正しいか
   - 他の受け渡し方法はあるか

4. **補足事項の追加・削除**
   - 他に記載すべき注意点はあるか

ご確認いただき、修正・追加があればお知らせください。
