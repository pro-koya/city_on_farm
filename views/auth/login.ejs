<%- include('../partials/header', { title: 'ログイン', extraCSS: '/styles/auth.css' }) %>

<main class="auth">
  <section class="auth__card" role="region" aria-labelledby="loginTitle">
    <h1 id="loginTitle" class="auth__title">ログイン</h1>
    <p class="auth__lead">ご登録のメールアドレスとパスワードを入力してください。</p>

    <!-- サーバー側のCSRFトークン（導入時に置き換え） -->
      <form id="loginForm" class="auth__form" method="POST" action="/login" novalidate>
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">

      <!-- Email -->
      <div class="field">
        <label class="label" for="email">メールアドレス</label>
        <input class="input" id="email" name="email" type="email" value="<%= (values && values.email) || '' %>" autocomplete="username" inputmode="email" aria-invalid="<%= fieldErrors && fieldErrors.email ? 'true' : 'false' %>" aria-describedby="<%= fieldErrors && fieldErrors.email ? 'error-email' : '' %>" required>
        <% if (fieldErrors && fieldErrors.email) { %>
        <p id="error-email" class="error <%= fieldErrors && fieldErrors.email ? 'is-visible' : '' %>" role="alert"><%= fieldErrors.email %></p>
        <% } %>
      </div>

      <!-- Password -->
      <div class="field">
        <label class="label" for="password">パスワード</label>
        <div class="pwd">
          <input class="input" id="password" name="password" type="password" autocomplete="current-password" aria-invalid="<%= fieldErrors && fieldErrors.password ? 'true' : 'false' %>" aria-describedby="<%= fieldErrors && fieldErrors.password ? 'error-password' : '' %>" required>
          <button class="toggle" type="button" aria-label="パスワードを表示/非表示">👁</button>
        </div>
        <% if (fieldErrors && fieldErrors.password) { %>
        <p id="error-password" class="error <%= fieldErrors && fieldErrors.email ? 'is-visible' : '' %>" role="alert"><%= fieldErrors.password %></p>
        <% } %>
      </div>

      <!-- Options -->
      <div class="row">
        <label class="check">
          <input id="remember" name="remember" type="checkbox" value="1">
          ログイン状態を保持（端末を共有している場合は非推奨）
        </label>
        <a class="link" href="/auth/forgot">パスワードをお忘れですか？</a>
      </div>

      <!-- Submit -->
      <button id="loginBtn" class="btn btn--primary btn--block" type="submit" disabled>ログイン</button>

      <!-- Divider -->
      <div class="divider"><span>または</span></div>

      <!-- Social (後で本実装しやすいようにプレースホルダ) -->
      <div class="oauth">
        <a class="btn btn--ghost btn--block oauth__btn" href="/auth/google">Googleで続行</a>
        <!-- <a class="btn btn--ghost btn--block oauth__btn" href="/auth/line">LINEで続行</a> など -->
      </div>

      <!-- Small notes -->
      <p class="muted small">
        初めての方は <a class="link" href="/signup">新規登録</a> へ。
      </p>
    </form>
  </section>
</main>

<script src="/js/auth-login.js"></script>
<%- include('../partials/footer') %>