<%- include('../partials/header', { title, extraCSS: '/styles/auth.css' }) %>

<main class="auth-container">
  <section class="auth-card">
    <h1 class="auth-title">新しいパスワードを設定</h1>

    <form method="post" action="/password/reset" class="auth-form" id="resetForm">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
      <input type="hidden" name="token"  value="<%= token %>">
      <input type="hidden" name="userId" value="<%= userId %>">

      <label class="auth-label">新しいパスワード</label>
      <div class="auth-input-wrap">
        <input type="password" name="password" id="pw" class="auth-input" placeholder="8文字以上（英大小・数字・記号を含む）" required>
        <button class="auth-eye" type="button" data-toggle="pw" aria-label="表示切替">👁</button>
      </div>
      <% if (fieldErrors.password) { %><div class="auth-error"><%= fieldErrors.password %></div><% } %>

      <label class="auth-label">確認用パスワード</label>
      <div class="auth-input-wrap">
        <input type="password" name="passwordConfirm" id="pw2" class="auth-input" required>
        <button class="auth-eye" type="button" data-toggle="pw2" aria-label="表示切替">👁</button>
      </div>
      <% if (fieldErrors.passwordConfirm) { %><div class="auth-error"><%= fieldErrors.passwordConfirm %></div><% } %>

      <div id="pwStrength" class="auth-hint"></div>

      <button class="auth-button" type="submit">パスワードを更新する</button>
    </form>

    <div class="auth-links"><a href="/login">ログインに戻る</a></div>
  </section>
</main>

<script src="/js/auth-reset.js"></script>
<%- include('../partials/footer') %>