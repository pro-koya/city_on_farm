<%- include('../partials/header', {
  title: post.title,
  extraCSS: ((typeof extraCSS!=='undefined' && extraCSS) ? extraCSS : ''),
  extraJS:  ((typeof extraJS!=='undefined' && extraJS) ? extraJS : '')
}) %>

<main class="np">
  <header class="np__hero">
    <h1 class="np__title"><%= post.title %></h1>
    <div class="np__meta">
      <span class="nm-badge"><%= post.category %></span>
      <% if (post.readTime) { %><span>• <%= post.readTime %>分</span><% } %>
    </div>
  </header>

  <article class="np__body">
    <!-- note本文（サニタイズ済み） -->
    <section class="np__content">
      <%- post.contentHtml %>
    </section>
  </article>

  <% if (related && related.length) { %>
    <section class="np__related">
      <h2>他の記事</h2>
      <div class="np__related-list">
        <% related.forEach(function(r){ %>
          <a class="np-rel" href="/blog/<%= r.slug %>">
            <img src="<%= r.thumbnail || '/images/placeholder.jpg' %>" alt="">
            <div class="np-rel__title"><%= r.title.length > 10 ? r.title.substring(0, 10) + '...' : r.title %></div>
            <% if (r.excerpt) { %>
              <p class="nm-card__excerpt"><%= r.excerpt.length > 18 ? r.excerpt.substring(0, 18) + '...続きを読む' : r.excerpt %></p>
            <% } %>
          </a>
        <% }) %>
      </div>
    </section>
  <% } %>

  <nav class="np__back">
    <a href="/blog">← 記事一覧へ</a>
  </nav>
</main>

<%- include('../partials/footer') %>