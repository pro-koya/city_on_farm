<%- include('../partials/header', {
  title: title || 'ブログ',
  extraCSS: ((typeof extraCSS!=='undefined' && extraCSS) ? extraCSS : ''),
  extraJS:  ((typeof extraJS!=='undefined' && extraJS) ? extraJS : '')
}) %>

<main class="nm">
  <header class="nm__hero">
    <h1>ブログ</h1>
    <p class="nm__lead">note の投稿を集約して表示しています。</p>
  </header>

  <section class="nm__grid">
    <% posts.forEach(function(post){ %>
      <article class="nm-card">
        <a class="nm-card__thumb" href="/blog/<%= post.slug %>">
          <img src="<%= post.thumbnail || '/images/placeholder.jpg' %>" alt="<%= post.title %>">
        </a>
        <div class="nm-card__body">
          <h2 class="nm-card__title">
            <a href="/blog/<%= post.slug %>"><%= post.title %></a>
          </h2>
          <div class="nm-card__meta">
            <span class="nm-badge"><%= post.category %></span>
            <% if (post.publishedAt) { %>
              <time datetime="<%= post.publishedAt.toISOString() %>">
                <%= post.publishedAt.toLocaleDateString('ja-JP') %>
              </time>
            <% } %>
          </div>
          <% if (post.excerpt) { %>
            <p class="nm-card__excerpt"><%= post.excerpt %></p>
          <% } %>
        </div>
      </article>
    <% }) %>
  </section>

  <% if (pagination && pagination.pageCount > 1) { %>
  <nav class="nm__pager" aria-label="ページャ">
    <% for (let p=1; p<=pagination.pageCount; p++){ %>
      <a class="nm-page <%= p===pagination.page?'is-active':'' %>"
         href="?<%= new URLSearchParams({ page: p }).toString() %>"><%= p %></a>
    <% } %>
  </nav>
  <% } %>
</main>

<%- include('../partials/footer') %>